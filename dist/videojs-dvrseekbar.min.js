/*! @name videojs-dvrseekbar @version 0.2.6 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsDvrseekbar=t(e.videojs)}(this,function(e){"use strict";var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},r={startTime:0},o=function(o){function a(s,i){t(this,a);var l=n(this,o.call(this,s));return l.btnLiveEl=null,l.oldSeekBar=null,l.options=e.mergeOptions(r,i),l.player.ready(function(){l.player.addClass("vjs-dvrseekbar"),l.player.controlBar.addClass("vjs-dvrseekbar-control-bar"),l.player.controlBar.progressControl&&l.player.controlBar.progressControl.addClass("vjs-dvrseekbar-progress-control");var t=document.createElement("div");l.newLink=document.createElement("button"),t.className="vjs-live-button vjs-control",l.newLink.innerHTML=document.getElementsByClassName("vjs-live-display")[0].innerHTML,l.newLink.id="liveButton",s.paused()||(l.newLink.className="vjs-live-label onair");var n=function(e){s.currentTime(s.seekable().end(0)),s.play()};l.newLink.addEventListener?l.newLink.addEventListener("click",n,!1):l.newLink.attachEvent&&l.newLink.attachEvent("onclick",function(){return n.apply(newLink,[window.event])}),t.appendChild(l.newLink);var r=document.getElementsByClassName("vjs-control-bar")[0],o=document.getElementsByClassName("vjs-progress-control")[0];r.insertBefore(t,o),e.log("dvrSeekbar Plugin ENABLED!")}),l.setSeekBar(),l.init(),l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,o),a.prototype.init=function(){var e=this;this.player.on("timeupdate",function(t){e.onTimeUpdate(e,t)}),this.player.on("play",function(e){}),this.player.on("pause",function(e){document.getElementById("liveButton").className="vjs-live-label"})},a.prototype.setSeekBar=function(){this.oldSeekBar=e.getComponent("SeekBar");var t=e.getComponent("SeekBar");t.prototype.dvrTotalTime=function(e){var t=e.seekable();return t&&t.length?t.end(0)-t.start(0):0},t.prototype.handleMouseMove=function(e){var t=void 0,n=void 0;if((t=n=this.player_.seekable())&&t.length){for(n=t.start(0)+this.calculateDistance(e)*this.dvrTotalTime(this.player_);n>=t.end(0);)n-=.1;this.player_.currentTime(n)}},t.prototype.updateAriaAttributes=function(){var t=void 0,n=void 0,r=this.player_.seekable();r&&r.length&&(t=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime(),n=0>(n=r.end(0)-t)?0:n,this.el_.setAttribute("aria-valuenow",Math.round(100*this.getPercent(),2)),this.el_.setAttribute("aria-valuetext",(0===t?"":"-")+e.formatTime(n,r.end(0))))}},a.prototype.onTimeUpdate=function(){var e=this.player.seekable(),t=document.getElementById("liveButton");e&&e.length&&(e.end(0)-this.player.currentTime()<30?t.className="vjs-live-label onair":t.className="vjs-live-label",this.player.duration(this.player.seekable().end(0)))},a.prototype.dispose=function(){this.player.removeClass("vjs-dvrseekbar"),this.player.controlBar.removeClass("vjs-dvrseekbar-control-bar"),this.player.controlBar.progressControl&&this.player.controlBar.progressControl.removeClass("vjs-dvrseekbar-progress-control"),Array.from(document.getElementsByClassName("vjs-live-button")).forEach(function(e){return e.remove()}),this.player.off("timeupdate"),o.prototype.dispose.call(this),e.log("the advanced plugin is being disposed")},a}((e=e&&e.hasOwnProperty("default")?e.default:e).getPlugin("plugin"));return e.registerPlugin("dvrseekbar",o),o.VERSION="__VERSION__",o});
